======================================================================
ğŸš€ WhatsApp Chat Auto-Export
======================================================================
ğŸ” STEP 1: Setting up Android environment...
Setting up Android environment...
ğŸ” Set ANDROID_HOME to: /Users/ajanderson/Library/Android/sdk
Stopping any existing Appium instances...
Starting Appium server...
âœ… Appium server started successfully
Checking device connection...
ğŸ” Found 1 connected device(s): ['100.65.67.81:34683']
Device already connected: 100.65.67.81:34683
Use device 100.65.67.81:34683? (Y/n): âœ… Using device: 100.65.67.81:34683
ğŸ” STEP 2: Connecting to WhatsApp...
Stopping WhatsApp (this does NOT delete any data)...
âœ… WhatsApp stopped
Setting up WebDriver options...
ğŸ” Using device UDID: 100.65.67.81:34683
Connecting to Appium server...
âœ… Driver connected successfully!
Waiting for WhatsApp to launch...
======================================================================
ğŸ” CRITICAL: Verifying WhatsApp is open and accessible
======================================================================
Current package: com.whatsapp
âœ… âœ“ Package confirmed: com.whatsapp
Current activity: .home.ui.HomeActivity
âœ… âœ“ Activity confirmed safe: .home.ui.HomeActivity
Checking for WhatsApp UI elements...
âœ… âœ“ Found 8 chat elements
âœ… âœ“ Found WhatsApp toolbar
âœ… âœ“ WhatsApp UI elements accessible
ğŸ” Lock check - Current activity: .home.ui.HomeActivity
ğŸ” Lock check - Current package: com.whatsapp
ğŸ” Lock check - Found 8 chat elements
âœ… âœ“ Phone is unlocked
======================================================================
âœ… âœ… VERIFICATION PASSED: WhatsApp is open and accessible
======================================================================
ğŸ” STEP 3: Navigating to main chats screen...
Checking WhatsApp state...
ğŸ” Current package: com.whatsapp
ğŸ” Current activity: .home.ui.HomeActivity
âœ… WhatsApp package detected!
âœ… Already on main chats screen!

======================================================================
ğŸ”§ Configuring Pipeline
======================================================================
âœ… Pipeline configured - output directory: /Users/ajanderson/whatsapp_test
  ğŸ¤ Audio/video transcription enabled
======================================================================
ğŸ“‹ INTERACTIVE MODE
======================================================================
ğŸ¤– Pipeline mode: Auto-continuing after 30s timeout
ğŸ“‹ Chats will be shown in original order (most recent first)
======================================================================
ğŸ“‹ INTERACTIVE MODE (Limited to 1 chats)
======================================================================
======================================================================
ğŸ” CRITICAL: Verifying WhatsApp is open and accessible
======================================================================
Current package: com.whatsapp
âœ… âœ“ Package confirmed: com.whatsapp
Current activity: .home.ui.HomeActivity
âœ… âœ“ Activity confirmed safe: .home.ui.HomeActivity
Checking for WhatsApp UI elements...
âœ… âœ“ Found 8 chat elements
âœ… âœ“ Found WhatsApp toolbar
âœ… âœ“ WhatsApp UI elements accessible
ğŸ” Lock check - Current activity: .home.ui.HomeActivity
ğŸ” Lock check - Current package: com.whatsapp
ğŸ” Lock check - Found 8 chat elements
âœ… âœ“ Phone is unlocked
======================================================================
âœ… âœ… VERIFICATION PASSED: WhatsApp is open and accessible
======================================================================
Loading chats (limited to 1)...
Collecting chats (limited to 1 for testing)...
ğŸ” Scrolling to top...
ğŸ” Reached top early - stopping scroll
ğŸ” Reached limit of 1 chats. Stopping collection.
ğŸ” Scrolling back to top after collection...
ğŸ” Reached top early - stopping scroll
âœ… Finished scrolling! Found 1 chats (limited to 1 for testing)

Found 1 chats:
----------------------------------------------------------------------
  1. Lindsay Walker

======================================================================
Select chats to export:
  - Chats are listed in original order
  - Enter chat numbers (comma-separated, e.g., 1,3,5)
  - Use ranges with hyphens (e.g., 100-200 or 1,3,5-10,20)
  - Enter 'all' to export all chats
  - Enter 'q', 'quit', or 'exit' to quit
  - Will default to 'all' after 30 seconds if no input is provided
======================================================================

Your selection: â±ï¸  30s remaining (will default to 'all' if no input)...
â±ï¸  25s remaining (will default to 'all' if no input)...
â±ï¸  20s remaining (will default to 'all' if no input)...
â±ï¸  15s remaining (will default to 'all' if no input)...

ğŸ“¤ Exporting 1 chat(s) with media...

Processing chat 1/1: 'Lindsay Walker'
======================================================================
ğŸ” CRITICAL: Verifying WhatsApp is open and accessible
======================================================================
Current package: com.whatsapp
âœ… âœ“ Package confirmed: com.whatsapp
Current activity: .home.ui.HomeActivity
âœ… âœ“ Activity confirmed safe: .home.ui.HomeActivity
Checking for WhatsApp UI elements...
âœ… âœ“ Found 8 chat elements
âœ… âœ“ Found WhatsApp toolbar
âœ… âœ“ WhatsApp UI elements accessible
ğŸ” Lock check - Current activity: .home.ui.HomeActivity
ğŸ” Lock check - Current package: com.whatsapp
ğŸ” Lock check - Found 8 chat elements
âœ… âœ“ Phone is unlocked
======================================================================
âœ… âœ… VERIFICATION PASSED: WhatsApp is open and accessible
======================================================================
Checking WhatsApp state...
ğŸ” Current package: com.whatsapp
ğŸ” Current activity: .home.ui.HomeActivity
âœ… WhatsApp package detected!
âœ… Already on main chats screen!
ğŸ” Clicking into chat 'Lindsay Walker'...
ğŸ” Using coordinate click at (336, 713)
ğŸ” After click, activity: .Conversation

======================================================================
ğŸ“¤ EXPORTING CHAT: 'Lindsay Walker' (with media)
======================================================================
ğŸ” STEP 1: Opening menu...
ğŸ” Found menu button by resource ID
âœ… Menu opened
ğŸ” STEP 2: Looking for 'More' option...
ğŸ” Found 'More' option: 'More'
âœ… 'More' clicked
ğŸ” STEP 3: Looking for 'Export chat' option...
ğŸ” Found 'Export chat' option: 'Export chat'
âœ… 'Export chat' clicked
ğŸ” STEP 4: Selecting 'Include media' or detecting text-only chat...
ğŸ” Media selection dialog expected - searching for options...
ğŸ” Found in button: 'Include media'
About to click: 'Include media'
âœ… âœ“ 'Include media' clicked
Waiting for share dialog to initialize...
ğŸ” Waiting for share dialog (attempt 1/7, waiting 2s)...
ğŸ” Share dialog detected by package name
âœ… âœ“ Share dialog ready
ğŸ” STEP 5: Selecting 'Drive' (Google Drive)...
ğŸ” Found 'Drive': 'Drive'
ğŸ” Verified: 'Drive' is Google Drive
âœ… 'Drive' selected - Google Drive window should now be opening
ğŸ” Waiting for Google Drive window to appear...
ğŸ” After clicking Drive - Package: com.google.android.apps.docs, Activity: .common.shareitem.UploadMenuActivity
ğŸ” After additional wait - Package: com.google.android.apps.docs, Activity: .common.shareitem.UploadMenuActivity
ğŸ” STEP 6: Clicking 'Upload' button in Google Drive window...
ğŸ” Found 'Upload' button by resource ID: 'Upload'
ğŸ” Verified: Found by resource ID 'com.google.android.apps.docs:id/save_button' - trusting it's the Upload button
âœ… 'Upload' button clicked - export should now be processing
âœ… SUCCESS: Export initiated for 'Lindsay Walker'
ğŸ“¤ Google Drive should now be handling the export...
ğŸ” Navigating back to main screen...

ğŸ”„ Starting pipeline processing for 'Lindsay Walker'...

======================================================================
Processing export: 'Lindsay Walker'
======================================================================
ğŸ” Temp directory: /var/folders/0j/g2kc9yj15n1d692kh_1z5nr80000gn/T/whatsapp_Lindsay_Walker_4ltlpgoe

----------------------------------------------------------------------
Phase 1: Download from Google Drive
----------------------------------------------------------------------
Connecting to Google Drive...
ğŸ” Credentials directory: /Users/ajanderson/.whatsapp_export
ğŸ” Token loaded successfully
Credentials expired. Refreshing...
Refreshing access token...
ğŸ” Credentials directory: /Users/ajanderson/.whatsapp_export
âœ… Token saved to: /Users/ajanderson/.whatsapp_export/google_credentials.json
âœ… Token refreshed successfully
âœ… Connected to Google Drive API
âœ… Google Drive connection established
Looking for: WhatsApp Chat with Lindsay Walker.zip
ğŸ” Found 2 files
ğŸ” Found file: WhatsApp Chat with Lindsay Walker.zip
ğŸ”   Modified: 2025-11-10T23:05:20.033Z
ğŸ”   Age: 376931.3s
ğŸ”   Size: 74.5 KB
âš ï¸ File is too old (376931s), waiting for fresh upload...
â³ Waiting 2s before retry 2/5...
ğŸ” Found 2 files
ğŸ” Found file: WhatsApp Chat with Lindsay Walker.zip
ğŸ”   Modified: 2025-11-10T23:05:20.033Z
ğŸ”   Age: 376933.9s
ğŸ”   Size: 74.5 KB
âš ï¸ File is too old (376934s), waiting for fresh upload...
â³ Waiting 4s before retry 3/5...
ğŸ” Found 2 files
ğŸ” Found file: WhatsApp Chat with Lindsay Walker.zip
ğŸ”   Modified: 2025-11-10T23:05:20.033Z
ğŸ”   Age: 376938.4s
ğŸ”   Size: 74.5 KB
âš ï¸ File is too old (376938s), waiting for fresh upload...
â³ Waiting 8s before retry 4/5...
ğŸ” Found 2 files
ğŸ” Found file: WhatsApp Chat with Lindsay Walker.zip
ğŸ”   Modified: 2025-11-10T23:05:20.033Z
ğŸ”   Age: 376947.0s
ğŸ”   Size: 74.5 KB
âš ï¸ File is too old (376947s), waiting for fresh upload...
â³ Waiting 16s before retry 5/5...
ğŸ” Found 2 files
ğŸ” Found file: WhatsApp Chat with Lindsay Walker.zip
ğŸ”   Modified: 2025-11-10T23:05:20.033Z
ğŸ”   Age: 376963.5s
ğŸ”   Size: 74.5 KB
âš ï¸ Using file despite age (376963s old)
Note: Found 2 files with this name, selected most recent
Downloading 1 file(s)...
Downloading:   0%|          | 0/1 [00:00<?, ?file/s]Downloading WhatsApp Chat with Lindsay Walker.zip:   0%|          | 0/1 [00:00<?, ?file/s]Downloading: WhatsApp Chat with Lindsay Walker.zip (76252 bytes)
ğŸ” Download progress: 100%
âœ… Downloaded to: /var/folders/0j/g2kc9yj15n1d692kh_1z5nr80000gn/T/whatsapp_Lindsay_Walker_4ltlpgoe/downloads/WhatsApp Chat with Lindsay Walker.zip
Downloading WhatsApp Chat with Lindsay Walker.zip: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.26s/file]Downloading WhatsApp Chat with Lindsay Walker.zip: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.26s/file]
âœ… Downloaded 1/1 file(s)
âœ… Downloaded: WhatsApp Chat with Lindsay Walker.zip

----------------------------------------------------------------------
Phase 2: Extract and Organize
----------------------------------------------------------------------

======================================================================
Phase 2: Extract and Organize
======================================================================
Scanning for WhatsApp chat files...
ğŸ” Searching in: /var/folders/0j/g2kc9yj15n1d692kh_1z5nr80000gn/T/whatsapp_Lindsay_Walker_4ltlpgoe/downloads
ğŸ” Found 1 total files in directory
ğŸ” Found matching file: WhatsApp Chat with Lindsay Walker.zip
ğŸ” Verified as zip file: WhatsApp Chat with Lindsay Walker.zip
âœ… Found 1 WhatsApp chat export file(s)
Moving files to processed folder...
ğŸ” Moved: WhatsApp Chat with Lindsay Walker.zip -> /var/folders/0j/g2kc9yj15n1d692kh_1z5nr80000gn/T/whatsapp_Lindsay_Walker_4ltlpgoe/downloads/WhatsApp Chats Processed/WhatsApp Chat with Lindsay Walker.zip
âœ… Moved 1 file(s) to processed folder
Adding .zip extension to files...
ğŸ” Already has .zip extension: WhatsApp Chat with Lindsay Walker.zip
âœ… Added .zip extension to 1 file(s)
Extracting zip files...
ğŸ“¦ ZIP contents for 'WhatsApp Chat with Lindsay Walker.zip':
   Total files: 1
   Transcript files (.txt): 1
   Media files: 0
âœ… âœ“ Extracted: WhatsApp Chat with Lindsay Walker.zip â†’ 1 files
âœ… Extracted 1 archive(s)
Organizing extracted content...
ğŸ” Processing folder: WhatsApp Chat with Lindsay Walker
ğŸ”   Moved transcript: WhatsApp Chat with Lindsay Walker.txt
âœ… Organization complete:
  Transcripts moved: 1
  Media files moved: 0
ğŸ” Media subdirectories found: []
ğŸ” Transcript: WhatsApp Chat with Lindsay Walker.txt
ğŸ”   Chat name: WhatsApp Chat with Lindsay Walker
ğŸ”   Media dir: /var/folders/0j/g2kc9yj15n1d692kh_1z5nr80000gn/T/whatsapp_Lindsay_Walker_4ltlpgoe/downloads/WhatsApp Chats Processed/media/WhatsApp Chat with Lindsay Walker
ğŸ”   Media dir exists: False
âœ… Organized 1 chat(s)

----------------------------------------------------------------------
Phase 3: Transcribe Audio/Video
----------------------------------------------------------------------

======================================================================
Phase 3: Transcribe Audio/Video
======================================================================
ğŸ” Initialized OpenAI Whisper with model: whisper-1
âœ… Total transcriptions: 0

----------------------------------------------------------------------
Phase 4: Build Output
----------------------------------------------------------------------

======================================================================
Phase 4: Build Final Outputs
======================================================================
Building outputs for 1 chat(s)

[1/1] Processing: WhatsApp Chat with Lindsay Walker.txt
======================================================================
Building output for: Lindsay Walker
======================================================================
Parsing transcript: WhatsApp Chat with Lindsay Walker.txt
Parsing transcript: WhatsApp Chat with Lindsay Walker.txt
âœ… Parsed 2942 messages, found 258 media references
Building merged transcript: transcript.txt
âœ… Merged transcript created: transcript.txt
âš ï¸ Media directory not found: /var/folders/0j/g2kc9yj15n1d692kh_1z5nr80000gn/T/whatsapp_Lindsay_Walker_4ltlpgoe/downloads/WhatsApp Chats Processed/media/WhatsApp Chat with Lindsay Walker
Copying media files to: /Users/ajanderson/whatsapp_test/Lindsay Walker/media
âœ… Copied 0 media file(s)
Copying transcriptions to: /Users/ajanderson/whatsapp_test/Lindsay Walker/transcriptions
âœ… Copied 0 transcription(s)
======================================================================
âœ… Output created: /Users/ajanderson/whatsapp_test/Lindsay Walker
  Messages: 2942
  Media references: 258
  Media files copied: 0
  Transcriptions copied: 0
======================================================================

======================================================================
Batch Build Summary
======================================================================
Chats processed: 1/1
Total messages: 2942
Total media files: 0
Total transcriptions: 0
======================================================================
âœ… Created 1 output(s) in: /Users/ajanderson/whatsapp_test
ğŸ” Cleaning up temporary files...
âœ… 
âœ… Successfully processed 'Lindsay Walker'
   Output: /Users/ajanderson/whatsapp_test/Lindsay Walker
âœ… âœ… Pipeline completed for 'Lindsay Walker'
   ğŸ“ Output: /Users/ajanderson/whatsapp_test/Lindsay Walker

âœ… Chat 'Lindsay Walker' EXPORTED
   â±ï¸  Time for this chat: 1m 2.6s
   â±ï¸  Total elapsed time: 1m 5.7s

======================================================================
âœ… EXPORT COMPLETE
======================================================================

ğŸ“Š FINAL STATISTICS:
   Total chats processed: 1
   Successfully exported: 1
   Skipped: 0

â±ï¸  TIMING SUMMARY:
   Total time taken: 1m 5.7s
   Average time per chat: 1m 2.6s

ğŸ“‹ RESULTS BY CHAT:
----------------------------------------------------------------------
   âœ… EXPORTED: Lindsay Walker (1m 2.6s)
Driver session closed
Stopping Appium server...
======================================================================
âœ… SCRIPT COMPLETE
======================================================================
